{"ast":null,"code":"var _jsxFileName = \"D:\\\\agri-community\\\\client\\\\src\\\\components\\\\VideoCall.jsx\",\n  _s = $RefreshSig$();\n// components/Marketplace/VideoCall.jsx\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { io } from \"socket.io-client\";\nimport SimplePeer from \"simple-peer\";\nimport \"../../styles/videoCall.css\"; // Import CSS\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io(\"http://localhost:5000\");\nconst VideoCall = () => {\n  _s();\n  const [me, setMe] = useState(\"\");\n  const [peerId, setPeerId] = useState(null);\n  const [stream, setStream] = useState(null);\n  const myVideoRef = useRef();\n  const peerVideoRef = useRef();\n  useEffect(() => {\n    socket.on(\"connect\", () => setMe(socket.id));\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(currentStream => {\n      setStream(currentStream);\n      myVideoRef.current.srcObject = currentStream;\n    });\n    socket.emit(\"join-room\", \"marketplace-room\");\n    socket.on(\"user-joined\", userId => {\n      setPeerId(userId);\n      startCall(userId);\n    });\n    socket.on(\"offer\", handleReceiveCall);\n    socket.on(\"answer\", handleAnswer);\n    socket.on(\"ice-candidate\", handleIceCandidate);\n  }, []);\n  const startCall = userId => {\n    const peer = new SimplePeer({\n      initiator: true,\n      trickle: false,\n      stream\n    });\n    peer.on(\"signal\", offer => {\n      socket.emit(\"offer\", {\n        to: userId,\n        offer,\n        from: me\n      });\n    });\n    peer.on(\"stream\", peerStream => {\n      peerVideoRef.current.srcObject = peerStream;\n    });\n    socket.on(\"answer\", data => {\n      if (data.to === me) peer.signal(data.answer);\n    });\n    socket.on(\"ice-candidate\", data => {\n      if (data.to === me) peer.signal(data.candidate);\n    });\n  };\n  const handleReceiveCall = ({\n    offer,\n    from\n  }) => {\n    const peer = new SimplePeer({\n      initiator: false,\n      trickle: false,\n      stream\n    });\n    peer.on(\"signal\", answer => {\n      socket.emit(\"answer\", {\n        to: from,\n        answer,\n        from: me\n      });\n    });\n    peer.on(\"stream\", peerStream => {\n      peerVideoRef.current.srcObject = peerStream;\n    });\n    peer.signal(offer);\n  };\n  const handleAnswer = data => {\n    if (data.to === me) peer.signal(data.answer);\n  };\n  const handleIceCandidate = data => {\n    if (data.to === me) peer.signal(data.candidate);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"video-call-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Live Video Call\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"My Video\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: myVideoRef,\n          autoPlay: true,\n          playsInline: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"Peer Video\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n          ref: peerVideoRef,\n          autoPlay: true,\n          playsInline: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoCall, \"eA5UR8dm0zsgeiD8KSOkQKmaE/w=\");\n_c = VideoCall;\nexport default VideoCall;\nvar _c;\n$RefreshReg$(_c, \"VideoCall\");","map":{"version":3,"names":["React","useEffect","useRef","useState","io","SimplePeer","jsxDEV","_jsxDEV","socket","VideoCall","_s","me","setMe","peerId","setPeerId","stream","setStream","myVideoRef","peerVideoRef","on","id","navigator","mediaDevices","getUserMedia","video","audio","then","currentStream","current","srcObject","emit","userId","startCall","handleReceiveCall","handleAnswer","handleIceCandidate","peer","initiator","trickle","offer","to","from","peerStream","data","signal","answer","candidate","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","playsInline","_c","$RefreshReg$"],"sources":["D:/agri-community/client/src/components/VideoCall.jsx"],"sourcesContent":["// components/Marketplace/VideoCall.jsx\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\nimport SimplePeer from \"simple-peer\";\r\nimport \"../../styles/videoCall.css\"; // Import CSS\r\n\r\nconst socket = io(\"http://localhost:5000\");\r\n\r\nconst VideoCall = () => {\r\n  const [me, setMe] = useState(\"\");\r\n  const [peerId, setPeerId] = useState(null);\r\n  const [stream, setStream] = useState(null);\r\n  const myVideoRef = useRef();\r\n  const peerVideoRef = useRef();\r\n\r\n  useEffect(() => {\r\n    socket.on(\"connect\", () => setMe(socket.id));\r\n\r\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then((currentStream) => {\r\n      setStream(currentStream);\r\n      myVideoRef.current.srcObject = currentStream;\r\n    });\r\n\r\n    socket.emit(\"join-room\", \"marketplace-room\");\r\n\r\n    socket.on(\"user-joined\", (userId) => {\r\n      setPeerId(userId);\r\n      startCall(userId);\r\n    });\r\n\r\n    socket.on(\"offer\", handleReceiveCall);\r\n    socket.on(\"answer\", handleAnswer);\r\n    socket.on(\"ice-candidate\", handleIceCandidate);\r\n  }, []);\r\n\r\n  const startCall = (userId) => {\r\n    const peer = new SimplePeer({ initiator: true, trickle: false, stream });\r\n\r\n    peer.on(\"signal\", (offer) => {\r\n      socket.emit(\"offer\", { to: userId, offer, from: me });\r\n    });\r\n\r\n    peer.on(\"stream\", (peerStream) => {\r\n      peerVideoRef.current.srcObject = peerStream;\r\n    });\r\n\r\n    socket.on(\"answer\", (data) => {\r\n      if (data.to === me) peer.signal(data.answer);\r\n    });\r\n\r\n    socket.on(\"ice-candidate\", (data) => {\r\n      if (data.to === me) peer.signal(data.candidate);\r\n    });\r\n  };\r\n\r\n  const handleReceiveCall = ({ offer, from }) => {\r\n    const peer = new SimplePeer({ initiator: false, trickle: false, stream });\r\n\r\n    peer.on(\"signal\", (answer) => {\r\n      socket.emit(\"answer\", { to: from, answer, from: me });\r\n    });\r\n\r\n    peer.on(\"stream\", (peerStream) => {\r\n      peerVideoRef.current.srcObject = peerStream;\r\n    });\r\n\r\n    peer.signal(offer);\r\n  };\r\n\r\n  const handleAnswer = (data) => {\r\n    if (data.to === me) peer.signal(data.answer);\r\n  };\r\n\r\n  const handleIceCandidate = (data) => {\r\n    if (data.to === me) peer.signal(data.candidate);\r\n  };\r\n\r\n  return (\r\n    <div className=\"video-call-container\">\r\n      <h2>Live Video Call</h2>\r\n      <div className=\"video-grid\">\r\n        <div className=\"video-box\">\r\n          <h3>My Video</h3>\r\n          <video ref={myVideoRef} autoPlay playsInline />\r\n        </div>\r\n        <div className=\"video-box\">\r\n          <h3>Peer Video</h3>\r\n          <video ref={peerVideoRef} autoPlay playsInline />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoCall;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}