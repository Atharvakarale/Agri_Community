{"ast":null,"code":"var _jsxFileName = \"D:\\\\agri-community\\\\client\\\\src\\\\components\\\\VideoCall.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io(\"http://localhost:5000\");\nconst VideoCall = () => {\n  _s();\n  const {\n    roomId\n  } = useParams();\n  const localVideoRef = useRef(null);\n  const remoteVideoRef = useRef(null);\n  let peerConnection;\n  useEffect(() => {\n    socket.emit(\"join-room\", roomId);\n\n    // Notify seller about the call\n    socket.on(\"incoming-call\", data => {\n      console.log(\"Incoming call from buyer:\", data);\n      alert(\"ðŸ“ž Incoming video call! Click OK to join.\");\n    });\n\n    // Handle WebRTC Offer & Answer\n    socket.on(\"offer\", async data => {\n      peerConnection = createPeerConnection();\n      await peerConnection.setRemoteDescription(data.offer);\n      const answer = await peerConnection.createAnswer();\n      await peerConnection.setLocalDescription(answer);\n      socket.emit(\"answer\", {\n        to: data.from,\n        answer\n      });\n    });\n    socket.on(\"answer\", async data => {\n      await peerConnection.setRemoteDescription(data.answer);\n    });\n    socket.on(\"ice-candidate\", async data => {\n      await peerConnection.addIceCandidate(data.candidate);\n    });\n    return () => socket.disconnect();\n  }, [roomId]);\n  const createPeerConnection = () => {\n    const config = {\n      iceServers: [{\n        urls: \"stun:stun.l.google.com:19302\"\n      }]\n    };\n    peerConnection = new RTCPeerConnection(config);\n    peerConnection.onicecandidate = event => {\n      if (event.candidate) {\n        socket.emit(\"ice-candidate\", {\n          to: roomId,\n          candidate: event.candidate\n        });\n      }\n    };\n    peerConnection.ontrack = event => {\n      remoteVideoRef.current.srcObject = event.streams[0];\n    };\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      localVideoRef.current.srcObject = stream;\n      stream.getTracks().forEach(track => peerConnection.addTrack(track, stream));\n    });\n    return peerConnection;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"video-call-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83D\\uDCDE Video Call\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: localVideoRef,\n      autoPlay: true,\n      playsInline: true,\n      className: \"local-video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: remoteVideoRef,\n      autoPlay: true,\n      playsInline: true,\n      className: \"remote-video\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => socket.disconnect(),\n      children: \"End Call\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoCall, \"/9WQBnYCTe+5xeaQAbQuWmzOfZU=\", false, function () {\n  return [useParams];\n});\n_c = VideoCall;\nexport default VideoCall;\nvar _c;\n$RefreshReg$(_c, \"VideoCall\");","map":{"version":3,"names":["useEffect","useRef","useParams","io","jsxDEV","_jsxDEV","socket","VideoCall","_s","roomId","localVideoRef","remoteVideoRef","peerConnection","emit","on","data","console","log","alert","createPeerConnection","setRemoteDescription","offer","answer","createAnswer","setLocalDescription","to","from","addIceCandidate","candidate","disconnect","config","iceServers","urls","RTCPeerConnection","onicecandidate","event","ontrack","current","srcObject","streams","navigator","mediaDevices","getUserMedia","video","audio","then","stream","getTracks","forEach","track","addTrack","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","playsInline","onClick","_c","$RefreshReg$"],"sources":["D:/agri-community/client/src/components/VideoCall.jsx"],"sourcesContent":["import { useEffect, useRef } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nconst socket = io(\"http://localhost:5000\");\r\n\r\nconst VideoCall = () => {\r\n  const { roomId } = useParams();\r\n  const localVideoRef = useRef(null);\r\n  const remoteVideoRef = useRef(null);\r\n  let peerConnection;\r\n\r\n  useEffect(() => {\r\n    socket.emit(\"join-room\", roomId);\r\n\r\n    // Notify seller about the call\r\n    socket.on(\"incoming-call\", (data) => {\r\n      console.log(\"Incoming call from buyer:\", data);\r\n      alert(\"ðŸ“ž Incoming video call! Click OK to join.\");\r\n    });\r\n\r\n    // Handle WebRTC Offer & Answer\r\n    socket.on(\"offer\", async (data) => {\r\n      peerConnection = createPeerConnection();\r\n      await peerConnection.setRemoteDescription(data.offer);\r\n      const answer = await peerConnection.createAnswer();\r\n      await peerConnection.setLocalDescription(answer);\r\n      socket.emit(\"answer\", { to: data.from, answer });\r\n    });\r\n\r\n    socket.on(\"answer\", async (data) => {\r\n      await peerConnection.setRemoteDescription(data.answer);\r\n    });\r\n\r\n    socket.on(\"ice-candidate\", async (data) => {\r\n      await peerConnection.addIceCandidate(data.candidate);\r\n    });\r\n\r\n    return () => socket.disconnect();\r\n  }, [roomId]);\r\n\r\n  const createPeerConnection = () => {\r\n    const config = {\r\n      iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\r\n    };\r\n    peerConnection = new RTCPeerConnection(config);\r\n\r\n    peerConnection.onicecandidate = (event) => {\r\n      if (event.candidate) {\r\n        socket.emit(\"ice-candidate\", { to: roomId, candidate: event.candidate });\r\n      }\r\n    };\r\n\r\n    peerConnection.ontrack = (event) => {\r\n      remoteVideoRef.current.srcObject = event.streams[0];\r\n    };\r\n\r\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true })\r\n      .then((stream) => {\r\n        localVideoRef.current.srcObject = stream;\r\n        stream.getTracks().forEach((track) => peerConnection.addTrack(track, stream));\r\n      });\r\n\r\n    return peerConnection;\r\n  };\r\n\r\n  return (\r\n    <div className=\"video-call-container\">\r\n      <h2>ðŸ“ž Video Call</h2>\r\n      <video ref={localVideoRef} autoPlay playsInline className=\"local-video\"></video>\r\n      <video ref={remoteVideoRef} autoPlay playsInline className=\"remote-video\"></video>\r\n      <button onClick={() => socket.disconnect()}>End Call</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoCall;\r\n"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,MAAM,QAAQ,OAAO;AACzC,SAASC,SAAS,QAAQ,kBAAkB;AAC5C,SAASC,EAAE,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtC,MAAMC,MAAM,GAAGH,EAAE,CAAC,uBAAuB,CAAC;AAE1C,MAAMI,SAAS,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACtB,MAAM;IAAEC;EAAO,CAAC,GAAGP,SAAS,CAAC,CAAC;EAC9B,MAAMQ,aAAa,GAAGT,MAAM,CAAC,IAAI,CAAC;EAClC,MAAMU,cAAc,GAAGV,MAAM,CAAC,IAAI,CAAC;EACnC,IAAIW,cAAc;EAElBZ,SAAS,CAAC,MAAM;IACdM,MAAM,CAACO,IAAI,CAAC,WAAW,EAAEJ,MAAM,CAAC;;IAEhC;IACAH,MAAM,CAACQ,EAAE,CAAC,eAAe,EAAGC,IAAI,IAAK;MACnCC,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEF,IAAI,CAAC;MAC9CG,KAAK,CAAC,2CAA2C,CAAC;IACpD,CAAC,CAAC;;IAEF;IACAZ,MAAM,CAACQ,EAAE,CAAC,OAAO,EAAE,MAAOC,IAAI,IAAK;MACjCH,cAAc,GAAGO,oBAAoB,CAAC,CAAC;MACvC,MAAMP,cAAc,CAACQ,oBAAoB,CAACL,IAAI,CAACM,KAAK,CAAC;MACrD,MAAMC,MAAM,GAAG,MAAMV,cAAc,CAACW,YAAY,CAAC,CAAC;MAClD,MAAMX,cAAc,CAACY,mBAAmB,CAACF,MAAM,CAAC;MAChDhB,MAAM,CAACO,IAAI,CAAC,QAAQ,EAAE;QAAEY,EAAE,EAAEV,IAAI,CAACW,IAAI;QAAEJ;MAAO,CAAC,CAAC;IAClD,CAAC,CAAC;IAEFhB,MAAM,CAACQ,EAAE,CAAC,QAAQ,EAAE,MAAOC,IAAI,IAAK;MAClC,MAAMH,cAAc,CAACQ,oBAAoB,CAACL,IAAI,CAACO,MAAM,CAAC;IACxD,CAAC,CAAC;IAEFhB,MAAM,CAACQ,EAAE,CAAC,eAAe,EAAE,MAAOC,IAAI,IAAK;MACzC,MAAMH,cAAc,CAACe,eAAe,CAACZ,IAAI,CAACa,SAAS,CAAC;IACtD,CAAC,CAAC;IAEF,OAAO,MAAMtB,MAAM,CAACuB,UAAU,CAAC,CAAC;EAClC,CAAC,EAAE,CAACpB,MAAM,CAAC,CAAC;EAEZ,MAAMU,oBAAoB,GAAGA,CAAA,KAAM;IACjC,MAAMW,MAAM,GAAG;MACbC,UAAU,EAAE,CAAC;QAAEC,IAAI,EAAE;MAA+B,CAAC;IACvD,CAAC;IACDpB,cAAc,GAAG,IAAIqB,iBAAiB,CAACH,MAAM,CAAC;IAE9ClB,cAAc,CAACsB,cAAc,GAAIC,KAAK,IAAK;MACzC,IAAIA,KAAK,CAACP,SAAS,EAAE;QACnBtB,MAAM,CAACO,IAAI,CAAC,eAAe,EAAE;UAAEY,EAAE,EAAEhB,MAAM;UAAEmB,SAAS,EAAEO,KAAK,CAACP;QAAU,CAAC,CAAC;MAC1E;IACF,CAAC;IAEDhB,cAAc,CAACwB,OAAO,GAAID,KAAK,IAAK;MAClCxB,cAAc,CAAC0B,OAAO,CAACC,SAAS,GAAGH,KAAK,CAACI,OAAO,CAAC,CAAC,CAAC;IACrD,CAAC;IAEDC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC;MAAEC,KAAK,EAAE,IAAI;MAAEC,KAAK,EAAE;IAAK,CAAC,CAAC,CAC9DC,IAAI,CAAEC,MAAM,IAAK;MAChBpC,aAAa,CAAC2B,OAAO,CAACC,SAAS,GAAGQ,MAAM;MACxCA,MAAM,CAACC,SAAS,CAAC,CAAC,CAACC,OAAO,CAAEC,KAAK,IAAKrC,cAAc,CAACsC,QAAQ,CAACD,KAAK,EAAEH,MAAM,CAAC,CAAC;IAC/E,CAAC,CAAC;IAEJ,OAAOlC,cAAc;EACvB,CAAC;EAED,oBACEP,OAAA;IAAK8C,SAAS,EAAC,sBAAsB;IAAAC,QAAA,gBACnC/C,OAAA;MAAA+C,QAAA,EAAI;IAAa;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACtBnD,OAAA;MAAOoD,GAAG,EAAE/C,aAAc;MAACgD,QAAQ;MAACC,WAAW;MAACR,SAAS,EAAC;IAAa;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAChFnD,OAAA;MAAOoD,GAAG,EAAE9C,cAAe;MAAC+C,QAAQ;MAACC,WAAW;MAACR,SAAS,EAAC;IAAc;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eAClFnD,OAAA;MAAQuD,OAAO,EAAEA,CAAA,KAAMtD,MAAM,CAACuB,UAAU,CAAC,CAAE;MAAAuB,QAAA,EAAC;IAAQ;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC1D,CAAC;AAEV,CAAC;AAAChD,EAAA,CApEID,SAAS;EAAA,QACML,SAAS;AAAA;AAAA2D,EAAA,GADxBtD,SAAS;AAsEf,eAAeA,SAAS;AAAC,IAAAsD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}